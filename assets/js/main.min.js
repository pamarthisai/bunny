const $ = (selector) => document.querySelector(selector);

function configureTopbar() {
    const $logo = $('#logo');
    if ($logo) {
        $logo.addEventListener('click', () => {
            window.location.href = '/';
        });
    }
}

function configureFeedbackModal() {
    const $modal = $('#feedbackModal');
    const $btn = $('#feedback-btn');
    const $close = $('#feedbackModal .close');
    const $text = $('#feedbackText');

    if ($btn) {
        $btn.onclick = () => {
            if ($modal) $modal.style.display = 'block';
        };
    }

    if ($close) {
        $close.onclick = () => {
            if ($modal) $modal.style.display = 'none';
        };
    }

    window.onclick = (e) => {
        if ($modal && e.target === $modal) {
            $modal.style.display = 'none';
        }
    };

    const $feedbackForm = $('#feedbackForm');
    if ($feedbackForm) {
        $feedbackForm.onsubmit = async (e) => {
            e.preventDefault();
            const feedback = $text ? $text.value : '';
            if ($text) $text.value = '';
            if ($modal) $modal.style.display = 'none';
            try {
                await fetch('/feedback', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        feedback,
                    }),
                });
            } catch (error) {
                console.error('Error sending feedback:', error);
            }
        };
    }
}

configureTopbar();
configureFeedbackModal();
